      * @package cms
      * @link    http://www.cmsvt.com
      * @author  s waite <cmswest@sover.net>
      * @copyright Copyright (c) 2020 cms <cmswest@sover.net>
      * @license https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3
       IDENTIFICATION DIVISION.
       PROGRAM-ID. RVS018.
       AUTHOR. SID WAITE.
       DATE-COMPILED. TODAY.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PROCFILE ASSIGN TO "S30" ORGANIZATION IS INDEXED
           ACCESS MODE IS DYNAMIC RECORD KEY IS PROC-KEY.
           SELECT MEDFILE2005 ASSIGN TO "S35" ORGANIZATION IS INDEXED
           ACCESS MODE IS DYNAMIC RECORD KEY IS MED-KEY
           LOCK MODE MANUAL.
           SELECT BILLPARM ASSIGN TO "S40" ORGANIZATION
           LINE SEQUENTIAL.
           SELECT FILEOUT ASSIGN TO "S45" ORGANIZATION
           LINE SEQUENTIAL.

       DATA DIVISION.
       FILE SECTION.
       FD MEDFILE2005.
       01 MEDFILE200501.
           02 MED-KEY.
             03 MED-KEY1 PIC X(5).
             03 MED-KEY2 PIC XX.
           02 MED-AMOUNT PIC 9(5)V99.
       FD PROCFILE
           DATA RECORD PROCFILE01.
       01 PROCFILE01.
           02 PROC-KEY. 
              03 PROC-KEY1 PIC X(5).
              03 PROC-KEY2 PIC XX.
           02 PROC-OLD PIC X(7).
           02 PROC-TYPE PIC X.
           02 PROC-BCBS PIC X(4).
           02 PROC-TITLE PIC X(28).
           02 PROC-AMOUNT PIC 9(4)V99.
           02 CARE-AMOUNT PIC 9(4)V99.
       
       FD  BILLPARM
           DATA RECORD IS BILLPARM01.
       01 BILLPARM01.
           02 FILLER PIC X(9).
           02 BP-2 PIC X(30).
       FD FILEOUT.
       01  FILEOUT01 PIC X(80).
       WORKING-STORAGE SECTION.
       01  O301.
           02 FO-PROC-KEY PIC X(7).
           02 FILLER PIC X VALUE SPACE.
           02 FO-TITLE PIC X(28).
           02 FILLER PIC XX VALUE SPACE.
           02 FO-PROC-AMOUNT PIC Z,ZZZ.ZZ.
           02 FILLER PIC X VALUE SPACE.
           02 FO-CARE-AMOUNT PIC Z,ZZZ.ZZ.
           02 FILLER PIC X VALUE SPACE.
           02 FO-NEW-AMOUNT PIC Z,ZZZ.ZZ.
           02 FILLER PIC X VALUE SPACE.
           02 FO-MED-AMOUNT PIC ZZ,ZZZ.ZZ.
           02 FILLER PIC X VALUE SPACE.
           02 FILLER PIC X VALUE SPACE.
           02 LOWCAREFEE PIC XX.
           02 FILLER PIC X VALUE SPACE.
           02 LOWREGFEE PIC XX.
       01 O101.
           02 FILLER PIC X(15) VALUE SPACE.
           02 O1F1 PIC X(45).
           02 FILLER PIC X(7) VALUE SPACE.
           02 O1F2 PIC 999.
       01  O201.
           02 FILLER PIC X(21) VALUE SPACE.
           02 O2F1 PIC X(12).
           02 FILLER PIC XXX VALUE SPACES.
           02 O2F2 PIC X(18).
       01  LINE-8.
           02 FILLER PIC X(23) VALUE SPACE.
           02 FILLER PIC X(16) VALUE "% INCREASE      ".
           02 L8F1 PIC ZZ9.
       01  LINE-9.
           02 FILLER PIC XX VALUE SPACE.
           02 FILLER PIC X(10) VALUE "CPT".
           02 FILLER PIC X(28) 
                 VALUE "   PROCEDURE DESCRIPTION        ".
           02 FILLER PIC X(8) VALUE "REGULAR ".
           02 FILLER PIC X(9) VALUE "MEDICARE ".
           02 FILLER PIC X(9) VALUE "INCREASE ".
           02 FILLER PIC X(9) VALUE "ALLOWABLE".
       01  NUM-2 PIC 99.
       01  NUM3 PIC 999.
       01  RIGHT-2 PIC XX JUST RIGHT.
       01  RIGHT-4 PIC XXXX JUST RIGHT.
       01  X PIC 99.
       01  ANS PIC X(32).
       01  FUNC PIC X(8).
       01  RVSMULT PIC 99.
       01  FLAG0 PIC X.
       01  NEW-AMOUNT PIC 9(4)V99.
       01  SAVE-AMOUNT PIC 9(4)V99.
       01  TAB601.
           02 TAB6 PIC X OCCURS 6 TIMES.
       01  TEST-DATE.
           05  T-CC            PIC 99.
           05  T-YY            PIC 99.
           05  T-MM            PIC 99.
           05  T-DD            PIC 99.
       01  DISPLAY-DATE.
           02 T-MM PIC XX.
           02 FILLER PIC X VALUE "/".
           02 T-DD PIC XX.
           02 FILLER PIC X VALUE "/".
           02 T-CC PIC XX.
           02 T-YY PIC XX.
       
       PROCEDURE DIVISION.
       P0. OPEN INPUT BILLPARM PROCFILE MEDFILE2005.
           OPEN OUTPUT FILEOUT.
           READ BILLPARM AT END GO TO S1.
       S1. DISPLAY "TYPE END OR ENTER TO CONTINUE".
           ACCEPT ANS.
           IF ANS = "END" GO TO Z1.
           ACCEPT TEST-DATE FROM CENTURY-DATE.
           MOVE CORR TEST-DATE TO DISPLAY-DATE
           MOVE DISPLAY-DATE TO O2F2
           DISPLAY "PERCENTAGE INCREASE ?  2-DIGITS"
           ACCEPT RVSMULT
           MOVE RVSMULT TO L8F1
           MOVE 1 TO O1F2.
           MOVE BP-2 TO O1F1.
           MOVE "FEE SCHEDULE" TO O2F1.
           DISPLAY "USE 0 AMOUNTS? Y/N"
           ACCEPT FLAG0.
           MOVE 0 TO X.
           PERFORM PFS3.
           MOVE SPACE TO PROC-KEY.
           START PROCFILE KEY NOT < PROC-KEY INVALID GO TO S1.
       PFS2. READ PROCFILE NEXT  AT END GO TO Z1.
           IF PROC-AMOUNT = 0 GO TO PFS2.
           ADD 1 TO X.
           IF X > 57 ADD 1 TO O1F2
           PERFORM PFS3
           MOVE 1 TO X.
           MOVE PROC-KEY TO FO-PROC-KEY
           MOVE PROC-KEY1 TO MED-KEY1
           MOVE PROC-KEY2 TO MED-KEY2
      *     MOVE SPACE TO MED-FAC
           READ MEDFILE2005 INVALID
           MOVE 0 TO MED-AMOUNT
           END-READ.
           MOVE PROC-TITLE TO FO-TITLE.
           MOVE PROC-AMOUNT TO FO-PROC-AMOUNT.
           MOVE MED-AMOUNT TO FO-MED-AMOUNT
           COMPUTE NEW-AMOUNT = 
                      (MED-AMOUNT * (100 + RVSMULT)) / 100.
           MOVE NEW-AMOUNT TO FO-NEW-AMOUNT
           MOVE CARE-AMOUNT TO FO-CARE-AMOUNT
           MOVE SPACE TO LOWCAREFEE LOWREGFEE
           IF MED-AMOUNT > CARE-AMOUNT
           MOVE "--" TO LOWCAREFEE.
           IF MED-AMOUNT > PROC-AMOUNT
           MOVE "??" TO LOWREGFEE.
           WRITE FILEOUT01 FROM O301.
           WRITE FILEOUT01 FROM O301.
      *     MOVE "#" TO MED-FAC
           MOVE MED-AMOUNT TO SAVE-AMOUNT
           READ MEDFILE2005 INVALID DISPLAY PROC-KEY " MISSING"
           GO TO PFS2.
           MOVE SPACE TO FO-TITLE
           MOVE "***  NON-OFFICE ALLOWABLE ***" TO FO-TITLE
           MOVE 0 TO FO-PROC-AMOUNT FO-NEW-AMOUNT
           MOVE MED-AMOUNT TO FO-MED-AMOUNT
           IF SAVE-AMOUNT NOT = MED-AMOUNT
           WRITE FILEOUT01 FROM O301.
           GO TO PFS2.
       PFS3. MOVE SPACE TO FILEOUT01 WRITE FILEOUT01 AFTER PAGE
           WRITE FILEOUT01 FROM O101
           WRITE FILEOUT01 FROM O201 AFTER 2
           WRITE FILEOUT01 FROM LINE-8
           WRITE FILEOUT01 FROM LINE-9.
       Z1. CLOSE PROCFILE FILEOUT. 
           STOP RUN.
