       IDENTIFICATION DIVISION.
       PROGRAM-ID. RPG002.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT NEWINS ASSIGN TO "S20" ORGANIZATION IS INDEXED
           ACCESS IS DYNAMIC RECORD KEY IS NEW-KEY
           LOCK MODE MANUAL.

           SELECT DIAGFILE ASSIGN TO "S25" ORGANIZATION IS INDEXED
           ACCESS IS DYNAMIC RECORD KEY IS DIAG-KEY
           ALTERNATE RECORD KEY IS DIAG-TITLE WITH DUPLICATES
           LOCK MODE MANUAL.

           SELECT RPGACTFILE ASSIGN TO "S30"     ORGANIZATION IS INDEXED
           ACCESS MODE IS DYNAMIC        RECORD KEY IS RPG-ACTNO
           ALTERNATE RECORD KEY IS RPG-GARNO WITH DUPLICATES
           ALTERNATE RECORD KEY IS NAME-KEY WITH DUPLICATES
           LOCK MODE MANUAL.
           SELECT RPGCHARFILE ASSIGN TO "S35" ORGANIZATION IS INDEXED
           ACCESS IS DYNAMIC  RECORD KEY IS RPGCHARFILE-KEY
           LOCK MODE MANUAL.
           
           SELECT RPGINSFILE ASSIGN TO "S40" ORGANIZATION IS INDEXED
           ACCESS IS DYNAMIC RECORD KEY IS RPGINS-KEY
           ALTERNATE RECORD KEY IS RPGINS-TITLE WITH DUPLICATES
           ALTERNATE RECORD KEY IS RPGINS-CITY WITH DUPLICATES
           ALTERNATE RECORD KEY IS RPGINS-STATE WITH DUPLICATES
           ALTERNATE RECORD KEY IS RPGINS-CMS WITH DUPLICATES
           ALTERNATE RECORD KEY IS RPGINS-GAP WITH DUPLICATES
           LOCK MODE MANUAL.
           SELECT RPGPROCFILE ASSIGN TO "S45" ORGANIZATION IS INDEXED
           ACCESS IS DYNAMIC RECORD KEY IS RPGPROC-KEY
           LOCK MODE MANUAL.

           SELECT FILEIN ASSIGN TO "S50"
           ORGANIZATION LINE SEQUENTIAL.

           SELECT FILEOUT ASSIGN TO "S55"
           ORGANIZATION LINE SEQUENTIAL.

           SELECT INSFILE ASSIGN TO "S60" ORGANIZATION IS INDEXED
           ACCESS IS DYNAMIC RECORD KEY IS INS-KEY
           ALTERNATE RECORD KEY IS INS-NAME WITH DUPLICATES
           ALTERNATE RECORD KEY IS INS-CITY WITH DUPLICATES
           ALTERNATE RECORD KEY IS INS-ASSIGN WITH DUPLICATES
           ALTERNATE RECORD KEY IS INS-CLAIMTYPE WITH DUPLICATES
           ALTERNATE RECORD KEY IS INS-NEIC WITH DUPLICATES
           ALTERNATE RECORD KEY IS INS-NEIC-ASSIGN WITH DUPLICATES
           LOCK MODE MANUAL.
           SELECT REFPHY ASSIGN TO "S65" ORGANIZATION IS INDEXED
           ACCESS IS DYNAMIC RECORD KEY IS REF-KEY
           ALTERNATE RECORD KEY IS REF-BSNUM  WITH DUPLICATES
           ALTERNATE RECORD KEY IS REF-CRNUM WITH DUPLICATES
           ALTERNATE RECORD KEY IS REF-UPIN  WITH DUPLICATES
           ALTERNATE RECORD KEY IS REF-CDNUM WITH DUPLICATES
           ALTERNATE RECORD KEY IS REF-NAME  WITH DUPLICATES
           LOCK MODE MANUAL.
           SELECT FILEOUT2 ASSIGN TO "S70"
           ORGANIZATION LINE SEQUENTIAL.
           SELECT NPIFILE ASSIGN TO "S70" ORGANIZATION IS INDEXED
             ACCESS IS DYNAMIC RECORD KEY IS NPI-KEY
             ALTERNATE RECORD KEY IS NPI-NAME WITH DUPLICATES
             ALTERNATE RECORD KEY IS NPI-REFKEY WITH DUPLICATES
             LOCK MODE MANUAL.
       DATA DIVISION.
       FILE SECTION.
       FD  NPIFILE.
       01  NPIFILE01.
           02 NPI-KEY PIC X(10).
           02 NPI-NAME PIC X(24).
           02 NPI-REFKEY PIC X(3).

       FD  NEWINS.
       01  NEWINS01.
           02 NEW-KEY PIC X(32).
           02 NEW-GARNAME PIC X(24).
           02 NEW-BILLADD PIC X(22).
           02 NEW-STREET PIC X(22).
           02 NEW-CITY PIC X(18).
           02 NEW-STATE PIC X(2).
           02 NEW-ZIP PIC X(9).
           02 NEW-COLLT PIC X.
           02 NEW-PHONE.
             03 NEW-PHONE1 PIC XXX.
             03 NEW-PHONE2 PIC XXX.
             03 NEW-PHONE3 PIC X(4).
           02 NEW-SEX PIC X.
           02 NEW-RELATE PIC X.
           02 NEW-MSTAT PIC X.
           02 NEW-DOB PIC X(8).
           02 NEW-DUNNING PIC X.
           02 NEW-ACCTSTAT PIC X.
           02 NEW-PR-MPLR PIC X(4).
           02 NEW-PRINS PIC XXX.
           02 NEW-PR-ASSIGN PIC X.
           02 NEW-PR-OFFICE PIC X(4).
           02 NEW-PR-GROUP PIC X(10).
           02 NEW-PRIPOL.
             03 NEW-PRIPOL1 PIC X(9).
             03 NEW-PRIPOL2 PIC XXX.
             03 NEW-PR-FILLER PIC X(4).
           02 NEW-PRNAME PIC X(24).
           02 NEW-PR-RELATE PIC X.
           02 NEW-SE-MPLR PIC X(4).
           02 NEW-SEINS PIC XXX.
           02 NEW-SE-ASSIGN PIC X.
           02 NEW-TRINSIND PIC X.
           02 NEW-TRINS PIC XXX.
           02 NEW-SE-GROUP PIC X(10).
           02 NEW-SECPOL.
             03 NEW-SECPOL1 PIC X(9).
             03 NEW-SECPOL2 PIC XXX.
             03 NEW-SE-FILLER PIC X(4).
           02 NEW-SENAME PIC X(24).
           02 NEW-SE-RELATE PIC X.
           02 NEW-INSPEND PIC X(7).
           02 NEW-LASTBILL PIC X(8).
           02 NEW-ASSIGNM PIC X.
           02 NEW-PRIVATE PIC X.
           02 NEW-BILLCYCLE PIC X.
           02 NEW-DELETE PIC X.
           02 NEW-FILLER PIC XXX.
           02 NEW-GARNO PIC X(8).
           02 NEW-PRGRPNAME PIC X(15).
           02 NEW-SEGRPNAME PIC X(15).
           02 NEW-NAME-KEY PIC XXX.
           
       FD  DIAGFILE.
       01  DIAG01.
           02 DIAG-KEY.
              03 diag-9 PIC X(5).
              03 diag-10 pic xx.
           02 DIAG-TITLE.
             03 DIAG-T1 PIC XXXXX.
             03 DIAG-T2 PIC X(56).
           02 DIAG-MEDB PIC X(5).
       FD  RPGPROCFILE.
       01  RPGPROCFILE01.
           02 RPGPROC-KEY.
             03 RPGPROC-KEY1 PIC X(7).
             03 RPGPROC-KEY2 PIC X(4).
           02 RPGPROC-TYPE PIC X.
           02 RPGPROC-TITLE. 
              03 RPG-NT1 PIC X(4).
              03 RPG-NT2 PIC X(24).
           02 RPGPROC-AMOUNT PIC 9(4)V99.
       
       FD  RPGCHARFILE.
       01  RPGCHARFILE01.
           02 RPGCHARFILE-KEY.
             03 RPG-KEY8 PIC X(32).
             03 RPG-KEY3 PIC XXX.
           02 RPG-PATID PIC X(8).
           02 RPG-CLAIM PIC X(6).
           02 RPG-SERVICE PIC X.
           02 RPG-DIAG PIC X(7).
           02 RPG-PROC. 
              03 RPG-PROC1 PIC X(4).
              03 RPG-PROC2 PIC X(7).
           02 RPG-MOD2 PIC XX.
           02 RPG-MOD3 PIC XX.
           02 RPG-MOD4 PIC XX.
           02 RPG-AMOUNT PIC X(6).
           02 RPG-DOCR PIC X(3).
           02 RPG-DOCP PIC X(2).
           02 RPG-PAYCODE PIC XXX.
           02 RPG-STAT PIC X.
           02 RPG-WORK PIC XX.
           02 RPG-DAT1 PIC X(8).
           02 RPG-RESULT PIC X.
           02 RPG-ACT PIC X.
           02 RPG-SORCREF PIC X.
           02 RPG-COLLECT PIC X.
           02 RPG-AUTH PIC X.
           02 RPG-PAPER PIC X.
           02 RPG-PLACE PIC X.
           02 RPG-NAME PIC X(24).
           02 RPG-EPSDT PIC X.
           02 RPG-DATE-T PIC X(8).
           02 RPG-DATE-E PIC X(8).
           02 RPG-ORDER PIC X(6).
           02 RPG-DX2 PIC X(7).
           02 RPG-DX3 PIC X(7).
           02 RPG-DATE-A PIC X(8).
           02 RPG-ACC-TYPE PIC X.
           02 RPG-DATE-M PIC X(8).
           02 RPG-ASSIGN PIC X.
           02 RPG-NEIC-ASSIGN PIC X.
           02 RPG-DX4 PIC X(7).
           02 RPG-DX5 PIC X(7).
           02 RPG-DX6 PIC X(7).
           02 RPG-FUTURE PIC X(6).
       FD  RPGACTFILE.
       01  RPGACTFILE01.
           02 RPG-ACTNO PIC X(32).
           02 RPG-GARNAME PIC X(24).
           02 RPG-BILLADD PIC X(22).
           02 RPG-STREET PIC X(22).
           02 RPG-CITY PIC X(18).
           02 RPG-STATE PIC X(2).
           02 RPG-ZIP PIC X(9).
           02 RPG-COLLT PIC X.
           02 RPG-PHONE.
             03 RPG-PHONE1 PIC XXX.
             03 RPG-PHONE2 PIC XXX.
             03 RPG-PHONE3 PIC X(4).
           02 RPG-SEX PIC X.
           02 RPG-RELATE PIC X.
           02 RPG-MSTAT PIC X.
           02 RPG-DOB PIC X(8).
           02 RPG-DUNNING PIC X.
           02 RPG-ACCTSTAT PIC X.
           02 RPG-PR-MPLR PIC X(4).
           02 RPG-PRINS PIC XXX.
           02 RPG-PR-ASSIGN PIC X.
           02 RPG-PR-OFFICE PIC X(4).
           02 RPG-PR-GROUP PIC X(10).
           02 RPG-PRIPOL.
             03 RPG-PRIPOL1 PIC X(9).
             03 RPG-PRIPOL2 PIC XXX.
             03 RPG-PR-FILLER PIC X(4).
           02 RPG-PRNAME PIC X(24).
           02 RPG-PR-RELATE PIC X.
           02 RPG-SE-MPLR PIC X(4).
           02 RPG-SEINS PIC XXX.
           02 RPG-SE-ASSIGN PIC X.
           02 RPG-TRINSIND PIC X.
           02 RPG-TRINS PIC XXX.
           02 RPG-SE-GROUP PIC X(10).
           02 RPG-SECPOL.
             03 RPG-SECPOL1 PIC X(9).
             03 RPG-SECPOL2 PIC XXX.
             03 RPG-SE-FILLER PIC X(4).
           02 RPG-SENAME PIC X(24).
           02 RPG-SE-RELATE PIC X.
           02 RPG-INSPEND PIC X(7).
           02 RPG-LASTBILL PIC X(8).
           02 RPG-ASSIGNM PIC X.
           02 RPG-PRIVATE PIC X.
           02 RPG-BILLCYCLE PIC X.
           02 RPG-DELETE PIC X.
           02 RPG-FILLER PIC XXX.
           02 RPG-GARNO PIC X(8).
           02 RPG-PRGRPNAME PIC X(15).
           02 RPG-SEGRPNAME PIC X(15).
           02 NAME-KEY PIC XXX.

       FD  RPGINSFILE.
       01  RPGINSFILE01.   
           02 RPGINS-KEY.  
              03 RPGINS-KEY10 PIC X(10).
              03 RPGINS-KEY2 PIC XX.
           02 RPGINS-TITLE PIC X(40).
           02 RPGINS-BOX PIC X(40).
           02 RPGINS-STREET PIC X(40).
           02 RPGINS-CITY PIC X(20).
           02 RPGINS-STATE PIC XX.
           02 RPGINS-ZIP PIC X(9).
           02 RPGINS-PHONE PIC X(10).
           02 RPGINS-CMS PIC XXX.
           02 RPGINS-GAP PIC X(7).
           02 RPGINS-FUTURE PIC X.
       
       FD  INSFILE.
       01  INSFILE01.
           02 INS-KEY PIC XXX.
           02 INS-NAME PIC X(22).
           02 INS-STREET PIC X(24).
           02 INS-CITY PIC X(15).
           02 INS-STATE PIC XX.
           02 INS-ZIP PIC X(9).
           02 INS-ASSIGN PIC X.
           02 INS-CLAIMTYPE PIC X.
           02 INS-NEIC PIC X(5).
           02 INS-NEICLEVEL PIC X.
           02 INS-NEIC-ASSIGN PIC X.
           02 INS-PPO PIC X.
           02 INS-PRVNUM PIC X(10).
           02 INS-HMO PIC X(3).
           02 INS-STATUS PIC X.
           02 INS-LEVEL PIC X.
           02 INS-LASTDATE PIC X(8).
           02 INS-CAID PIC XXX.
           02 INS-REFWARN PIC X.
           02 INS-FUTURE PIC X(8).
       FD  FILEOUT.
       01  FILEOUT01 PIC X(80).
       FD  FILEOUT2.
       01  FILEOUT201 PIC X(800).
       FD  FILEIN.
       01  FILEIN01.



           02 FI-PATNAMEL PIC X(24).
           02 FI-PATNAMEF PIC X(24).
           02 FI-PAT-STR1 PIC X(22).
           02 FI-PAT-STR2 PIC X(22).
           02 FI-PAT-CITY PIC X(18).
           02 FI-PAT-STATE PIC XX.
           02 FI-PAT-ZIP PIC X(9).
           02 FI-PAT-DOB PIC X(10).
           02 FI-PAT-SEX PIC X.
           02 FI-PRIM-ALFA PIC X(10).
           02 FI-PRIM-NAME PIC X(30).
           02 FI-PRIM-STR1 PIC X(22).
           02 FI-PRIM-CITY PIC X(18).
           02 FI-PRIM-STATE PIC XX.
           02 FI-PRIM-ZIP PIC X(10).
           02 FI-PRIM-GRP PIC X(10).
           02 FI-PRIM-POL PIC X(16).
           02 FI-PRIM-NAMEL PIC X(24).
           02 FI-PRIM-NAMEF PIC X(24).
           02 FI-PRIM-SUBSEX PIC X(10).
           02 FI-PRIM-SUBRELATE PIC XXXX.
           02 FI-SEC-ALFA PIC X(10).
           02 FI-SEC-NAME PIC X(30).
           02 FI-SEC-STR1 PIC X(22).
           02 FI-SEC-CITY PIC X(18).
           02 FI-SEC-STATE PIC XX.
           02 FI-SEC-ZIP PIC X(10).
           02 FI-SEC-GRP PIC X(10).
           02 FI-SEC-POL PIC X(16).
           02 FI-SEC-NAMEL PIC X(24).
           02 FI-SEC-NAMEF PIC X(24).
           02 FI-SEC-SUBSEX PIC X(10).
           02 FI-SEC-SUBRELATE PIC XXXX.
           02 FI-PROC.
               03 FI-PROC1 PIC X(5).
               03 FI-PROC2 PIC XX.
           02 FI-DX1 PIC X(8).
           02 FI-DX2 PIC X(8).
           02 FI-DX3 PIC X(8).
           02 FI-DX4 PIC X(8).
           02 FI-DATE-T PIC X(10).
           02 FI-PROVNPI PIC X(10).
           02 FI-DAT1 PIC X(10).
           02 FI-3RD-ALFA PIC X(10).
           02 FI-3RD-POL PIC X(16).
           02 FI-4TH-ALFA PIC X(10).
           02 FI-4TH-POL PIC X(16).

       FD  REFPHY
           BLOCK CONTAINS 5 RECORDS
           DATA RECORD IS REFPHY01.
       01  REFPHY01.
           02 REF-KEY PIC XXX.
           02 REF-BSNUM PIC X(5).
           02 REF-CRNUM PIC X(6).
           02 REF-UPIN PIC X(6).
           02 REF-CDNUM PIC X(7).
           02 REF-NAME.
             03 REF-TITLE4 PIC XXXX.
             03 FILLER PIC X(20).
           02 REF-KP PIC X(7).
           02 REF-FUTURE PIC XXX.
       WORKING-STORAGE SECTION.

       01 XXXPOL.
          02 XXXPOL-1 PIC XXX.
          02 XXXPOL-2 PIC X(11).
       01  NAME-TEST  PIC X(25).
       01  NAME-LAST  PIC X(24).
       01  NAME-FIRST  PIC X(24).
       01  NAME-MIDDLE PIC X(24).
       01  TEST-DATE.
           02 T-YYYY PIC XXXX.
           02 T-MM PIC XX.
           02 T-DD PIC XX.
       01  DISPLAY-DATE.
           02 DD-MM PIC XX.
           02 FILLER PIC X.
           02 DD-DD PIC XX.
           02 FILLER PIC X.
           02 DD-YYYY PIC XXXX.
       01  DOB-DATE.
           02 DD-YYYY PIC XXXX.
           02 DD-MM PIC XX.
           02 DD-DD PIC XX.
       01  DATE-TODAY PIC X(8).
       01  SAVEMASTER.
           02 S-ACTNO PIC X(32).
           02 S-GARNAME PIC X(24).
           02 S-BILLADD PIC X(22).
           02 S-STREET PIC X(22).
           02 S-CITY PIC X(18).
           02 S-STATE PIC X(2).
           02 S-ZIP PIC X(9).
           02 S-COLLT PIC X.
           02 S-PHONE PIC X(10).
           02 S-SEX PIC X.
           02 S-RELATE PIC X.
           02 S-MSTAT PIC X.
           02 S-DOB PIC X(8).
           02 S-DUNNING PIC X.
           02 S-ACCTSTAT PIC X.
           02 S-PR-MPLR PIC X(4).
           02 S-PRINS PIC XXX.
           02 S-PR-ASSIGN PIC X.
           02 S-PR-OFFICE PIC X(4).
           02 S-PR-GROUP PIC X(10).
           02 S-PRIPOL PIC X(16).
           02 S-PRNAME PIC X(24).
           02 S-PR-RELATE PIC X.
           02 S-SE-MPLR PIC X(4).
           02 S-SEINS PIC XXX.
           02 S-SE-ASSIGN PIC X.
           02 S-TRINSIND PIC X.
           02 S-TRINS PIC XXX.
           02 S-SE-GROUP PIC X(10).
           02 S-SECPOL PIC X(16).
           02 S-SENAME PIC X(24).
           02 S-SE-RELATE PIC X.
           02 S-INSPEND PIC X(7).
           02 S-LASTBILL PIC X(8).
           02 S-ASSIGNM PIC X.
           02 S-PRIVATE PIC X.
           02 S-BILLCYCLE PIC X.
           02 S-DELETE PIC X.
           02 S-FILLER PIC XXX.
           02 S-GARNO PIC X(8).
           02 S-PRGRPNAME PIC X(15).
           02 S-SEGRPNAME PIC X(15).
           02 S-NAME-KEY PIC XXX.
       01  SAVE-RPGCHARFILE PIC X(213).
       01     RIGHT-2 PIC XX JUST RIGHT.
       01     ALF-1 PIC X.
       01     XALF-1 PIC X.
       01  ALF-3 PIC XXX.
       01  ALF-4 PIC XXXX.
       01     ALF-5 PIC X(5).
       01     ALF-7 PIC X(7).
       01     ALF-7X. 
              02 ALF-7X1 PIC X(5).
              02 ALF-7X2 PIC XX.
       01  ALF-8 PIC X(8).
       01  ALF-9.
           02 ALF-9-1.
             03 ALF-9-11 PIC X.
             03 FILLER PIC X.
           02 ALF-9-2 PIC X(7).
       01     ALF-13 PIC X(13).
       01     YEARDAY.
             03 YEAR-1.
               04 YD1 PIC X.
               04 YD2 PIC X.
             03 DAY3 PIC XXX.
       01     ABC PIC X.
       01     XYZ PIC 999.
       01     RIGHT-4 PIC X(4) JUST RIGHT.
       01  ALF-6 PIC X(6).
       01   RIGHT-3 PIC XXX JUST RIGHT.
       01     RIGHT-5 PIC X(5) JUST RIGHT.
       01     RIGHT-7 PIC X(7) JUST RIGHT.
       01     RIGHT-8 PIC X(8) JUST RIGHT.
       01     A PIC 99.
       01     B PIC 99.
       01     C PIC 99.
       01     D PIC 99.
       01     X PIC 99.
       01     Y PIC 99.
       01  Z PIC 999.
       01     FLAG   PIC 9.
       01  FLAGX PIC 9.
       01  ENDFLAG PIC 9 VALUE 0.
       01  DATE-X PIC X(8).
       01  IN-FIELD-8 PIC X(8).
       01  IN-FIELD PIC X(15).
       01  IN-FIELD-6 PIC X(6).
       01  NAME1.
           02 NAME11 PIC X.
           02 NAME12 PIC X(23).
       01  HOLDGARNO PIC X(8).
       01  NAMETAB01.
           02 NAMETAB PIC X(24) OCCURS 90 TIMES.
       01  NAMEKEYTAB01.
           02 NAMEKEYTAB PIC XXX OCCURS 90 TIMES.
       01  NUMKEYTAB01.
           02 NUMKEYTAB PIC X(4) OCCURS 90 TIMES.
       01  ALF-1X PIC X.
       01  ALF-2 PIC XX.
       01  REFFLAG PIC 9.
       01  X-IP PIC X(8).
       01  X-LASTNAME PIC X(16).
       01  X-FIRSTNAME PIC X(9).
       01  X-SUBNAME PIC X(30).
       01  X-SSN PIC X(9).
       01  X-RELATE PIC XX.
       01  Y-RELATE PIC XX.
       01  RELATECODE PIC X.
       01  GARRELATE PIC X.
       01  POLTEST.
           02 POLTEST1.
             03 POLTEST1-1 PIC X.
             03 POLTEST1-2 PIC X.
           02 FILLER PIC X(7).
           02 POLTEST2 PIC XX.
           02 FILLER PIC XXX.
       01  ALF4 PIC X(4).
       01  ALF6 PIC X(6).
       01  ALF8TEST.
           02 ALF8TEST1 PIC XX.
           02 FILLER PIC X(6).
       01  ALF8 PIC X(8).
       01  ALF8X PIC X(8).

       01  MONTH-TABLE-CONS.
           05  FILLER PIC X(24) VALUE "312931303130313130313031".
       01  MONTH-TABLE REDEFINES MONTH-TABLE-CONS.
           05  DAYS-IN-MONTH OCCURS 12 TIMES PIC 99.
       01  SERVDATE PIC X(8).
       01  REF PIC XXX.
       01  IOPAT PIC X.
       01  PLANNUM PIC 9.
       01  TAB1601.
           02 TAB16 PIC X OCCURS 16 TIMES.
       01  NEWTAB01.
           02 NEWTAB PIC X OCCURS 16 TIMES.
       01  YNDX USAGE IS INDEX.
       01  IN-FIELD-1 PIC X.
       01  IN-FIELD-3 PIC XXX.
       01  IN-FIELD-4 PIC X(4).
       01  IN-FIELD-15 PIC X(15).
       01  IN-FIELD-14 PIC X(14).
       01  X-MEDREC.
              02 X-MEDREC0 PIC XX VALUE "00".
              02 X-MEDREC1 PIC XX.
              02 X-MEDREC2 PIC XX.
              02 X-MEDREC3 PIC XX.
       01  ALF5 PIC X(5).
       01  alf7 pic x(7).
       01  ALF-14.
           02 ALF-14-1.
              03 ALF-14-11 PIC X.
              03 ALF-14-12 PIC X.
              03 ALF-14-13 PIC X.
           02 ALF-14-2 PIC X(9).
           02 ALF-14-3 PIC XX.
       01  ALF14X.
           02 ALF14X-12 PIC X(12).
           02 ALF14X-2 PIC XX.
       01  ZIPCODE.
           02 ZIPCODE-1-5 PIC X(5).
           02 ZIPCODE-6 PIC X.
           02 ZIPCODE-7-10 PIC X(4).
       01  ANS PIC XXX.
       01  ALFATAB01.
           02 ALFATAB PIC X OCCURS 8 TIMES.
       01  DIAGTAB01.
           02 DIAGTAB PIC X OCCURS 7 TIMES.
       01  DIAG-ARRAY01.
           02 DIAG-ARRAY PIC X(7) OCCURS 4 TIMES.
       01  CNTR PIC 99.
       01  CNTR-X PIC 9.
       01  CNTR-Y PIC 9.
       01  NUM6 PIC 9(6).
       01  ALF22 PIC X(22).
       01  ALF22X PIC X(22).
       01  INSTAB01.
           02 INSTAB PIC X(12) OCCURS 50 TIMES.
       01  INSCMS01.
           02 INSCMS PIC XXX OCCURS 50 TIMES.
       01  TALLYX PIC 9.
       01  TALLYRT PIC 9.
       01  TALLYlT PIC 9.
       01  TALLYRIT PIC 9.
       01  TALLYLIT PIC 9.
       01  TALLYR PIC 9.
       01  TALLYL PIC 9.
       01  PRIM-DOB PIC X(8).
       01  SECDOB PIC X(8).

       PROCEDURE DIVISION.
       0005-START.
           OPEN OUTPUT NEWINS
           CLOSE NEWINS.
           OPEN I-O NEWINS
           OPEN I-O RPGACTFILE.
           OPEN I-O RPGCHARFILE RPGINSFILE.
           OPEN INPUT RPGPROCFILE REFPHY INSFILE
                      NPIFILE FILEIN DIAGFILE.
           OPEN OUTPUT FILEOUT FILEOUT2.
           ACCEPT DATE-TODAY  FROM CENTURY-DATE.
       P1. 
           PERFORM INIT-1.
           READ FILEIN AT END GO TO P99.
           IF FI-PROC1 = "76499" GO TO P1.
            STRING FI-PATNAMEL ";" FI-PATNAMEF DELIMITED BY "  " INTO
            RPG-GARNAME
           MOVE RPG-GARNAME(1:3) TO NAME-KEY


           MOVE SPACE TO RPG-DOB TEST-DATE
           UNSTRING FI-PAT-DOB DELIMITED BY "/" INTO T-MM T-DD T-YYYY

           MOVE SPACE TO RIGHT-2
           UNSTRING T-MM DELIMITED BY " " INTO RIGHT-2
           INSPECT RIGHT-2 REPLACING ALL " " BY "0"
           MOVE RIGHT-2 TO T-MM

           MOVE SPACE TO RIGHT-2
           UNSTRING T-DD DELIMITED BY " " INTO RIGHT-2
           INSPECT RIGHT-2 REPLACING ALL " " BY "0"
           MOVE RIGHT-2 TO T-DD
           MOVE TEST-DATE TO RPG-DOB



           MOVE SPACE TO RPG-ACTNO
           STRING RPG-GARNAME RPG-DOB DELIMITED BY SIZE INTO RPG-ACTNO.
           MOVE FI-PAT-STR1 TO RPG-BILLADD
           MOVE FI-PAT-STR2 TO RPG-STREET
           MOVE FI-PAT-CITY TO RPG-CITY
           MOVE FI-PAT-STATE TO RPG-STATE
           MOVE FI-PAT-ZIP TO RPG-ZIP
           IF RPG-ZIP(1:5) = " "
            MOVE SPACE TO ALF5
            STRING "0" RPG-ZIP(1:4) DELIMITED BY SIZE INTO ALF5
            MOVE SPACE TO RPG-ZIP
            MOVE ALF5 TO RPG-ZIP
           END-IF
           MOVE "M" TO RPG-SEX
           IF FI-PAT-SEX = "F" MOVE "F" TO RPG-SEX.
           MOVE "2" TO RPG-RELATE
           IF RPG-SEX = "F" MOVE "K" TO RPG-RELATE.
           IF FI-PRIM-ALFA = SPACE 
           MOVE "001" TO RPG-PRINS
           MOVE "U" TO RPG-PR-ASSIGN RPG-ASSIGN RPG-NEIC-ASSIGN
           GO TO P1-1.
            STRING FI-PRIM-NAMEL ";" FI-PRIM-NAMEF 
            DELIMITED BY "  " INTO RPG-PRNAME
           IF FI-PRIM-SUBRELATE = "C"
              MOVE "4" TO RPG-RELATE
              IF RPG-SEX = "F" MOVE "M" TO RPG-RELATE
              END-IF
           END-IF.
           MOVE FI-PRIM-GRP TO RPG-PR-GROUP
           MOVE SPACE TO TAB1601
           MOVE FI-PRIM-POL TO RPG-PRIPOL

           MOVE RPG-RELATE TO RPG-PR-RELATE
           MOVE RPG-GARNAME TO RPG-PRNAME
           GO TO SEC-1.
           MOVE "2" TO RPG-PR-RELATE
           IF FI-PRIM-SUBRELATE = " " MOVE RPG-RELATE TO RPG-PR-RELATE.
           IF FI-PRIM-SUBRELATE = "P" AND RPG-SEX = "M" 
           MOVE "K" TO RPG-PR-RELATE.
       SEC-1.    
           IF FI-SEC-ALFA = SPACE 
           MOVE "001" TO RPG-SEINS
           MOVE "U" TO RPG-SE-ASSIGN 
           GO TO RPGINS-1.

            STRING FI-SEC-NAMEL ";" FI-SEC-NAMEF 
            DELIMITED BY "  " INTO RPG-SENAME
           IF FI-SEC-SUBRELATE = "C"
              MOVE "4" TO RPG-RELATE
              IF RPG-SEX = "F" MOVE "M" TO RPG-RELATE
              END-IF
           END-IF.
           MOVE FI-SEC-GRP TO RPG-SE-GROUP
           MOVE SPACE TO TAB1601
           MOVE FI-SEC-POL TO RPG-SECPOL
           IF RPG-GARNAME = RPG-SENAME
           MOVE RPG-RELATE TO RPG-SE-RELATE
           GO TO RPGINS-1.
           MOVE "2" TO RPG-SE-RELATE
           IF FI-SEC-SUBRELATE = " " MOVE RPG-RELATE TO RPG-SE-RELATE.
           IF FI-SEC-SUBRELATE = "P" AND RPG-SEX = "M" 
           MOVE "K" TO RPG-SE-RELATE.


       RPGINS-1.
           MOVE 0 TO CNTR
           MOVE SPACE TO RPGINS-KEY
           MOVE FI-PRIM-ALFA TO RPGINS-KEY10
           
           START RPGINSFILE KEY NOT < RPGINS-KEY
                     INVALID GO TO RPGINS-3.
       RPGINS-2.
           READ RPGINSFILE NEXT AT END GO TO RPGINS-3.
           IF RPGINS-KEY10 > FI-PRIM-ALFA GO TO RPGINS-3.
           ADD 1 TO CNTR
           IF FI-PRIM-ALFA(1:3) = "CIG"
            MOVE "CIGN      " TO INSTAB(CNTR)
            MOVE "102" TO INSCMS(CNTR)
            GO TO RPGINS-3
           END-IF
           MOVE RPGINS-KEY TO INSTAB(CNTR)
           MOVE RPGINS-CMS TO INSCMS(CNTR)
           IF RPGINS-KEY10 = FI-PRIM-ALFA GO TO RPGINS-3.
           IF (RPGINS-CITY = FI-PRIM-CITY)
            AND (RPGINS-STREET = FI-PRIM-STR1)
            COMPUTE CNTR = 1
            MOVE RPGINS-KEY TO INSTAB(CNTR)
            MOVE RPGINS-CMS TO INSCMS(CNTR)
            GO TO RPGINS-3
           END-IF
      *     DISPLAY CNTR " " RPGINS-KEY " " RPGINS-STREET
           
           IF CNTR > 14
            ACCEPT ANS
            IF ANS = "BK" 
             GO TO RPGINS-1
            END-IF
            IF ANS = SPACE 
             MOVE 0 TO CNTR
             GO TO RPGINS-2
            END-IF
           MOVE SPACE TO RIGHT-2
           UNSTRING ANS DELIMITED BY " " INTO RIGHT-2
           INSPECT RIGHT-2 REPLACING ALL " " BY "0"
            IF RIGHT-2 NUMERIC AND RIGHT-2 NOT = "00"
             GO TO RPGINS-1
            END-IF
           MOVE RIGHT-2 TO X
           MOVE INSCMS(X) TO RPG-PRINS
           MOVE INSTAB(X) TO RPGINS-KEY
           GO TO RPGINS-4
           END-IF.
           GO TO RPGINS-2.
       RPGINS-3.
           IF CNTR = 1
            MOVE INSCMS(1) TO RPG-PRINS
            MOVE INSTAB(1) TO RPGINS-KEY
            GO TO RPGINS-4.
           IF CNTR = 0 
           PERFORM ADD-INS THRU ADD-INS-EXIT
           GO TO P1-1.
           DISPLAY "NO SELECTION WAS MADE"
           DISPLAY "DO YOU WISH TO ADD AS A NEW INSURANCE?  Y"
           
           DISPLAY FI-PRIM-ALFA " " FI-PRIM-NAME
           DISPLAY FI-PRIM-STR1 
           DISPLAY FI-PRIM-CITY " " FI-PRIM-STATE " " FI-PRIM-ZIP 
           DISPLAY " "
           ACCEPT ANS
           IF ANS = "Y" MOVE 0 TO CNTR GO TO RPGINS-3.
           GO TO RPGINS-1.
       RPGINS-4.
           MOVE RPG-PRINS TO INS-KEY
           READ INSFILE INVALID 
              DISPLAY RPGINS-KEY " HAS A BAD 3-DIGIT CODE " RPG-PRINS
              DISPLAY "FIX IT AND RESTART PROGRAM"
              ACCEPT ANS
              GO TO P99
           END-READ
           MOVE INS-ASSIGN TO RPG-PR-ASSIGN
           MOVE INS-KEY TO RPG-PRINS
           MOVE INS-ASSIGN TO RPG-ASSIGN
           MOVE INS-KEY TO RPG-PAYCODE
           MOVE INS-NEIC-ASSIGN TO RPG-NEIC-ASSIGN
           MOVE INS-CLAIMTYPE TO RPG-PAPER
             IF RPG-PRINS = "076" OR "091"
              MOVE RPGINS-KEY TO RPG-PR-GROUP
              MOVE "P" TO RPG-PAPER
              MOVE "A" TO RPG-PR-ASSIGN RPG-ASSIGN RPG-NEIC-ASSIGN
             END-IF.
       
       
       SE-RPGINS-1.
           IF FI-SEC-ALFA = SPACE GO TO P1-1.
           MOVE 0 TO CNTR
           MOVE SPACE TO RPGINS-KEY
           MOVE FI-SEC-ALFA TO RPGINS-KEY10
           
           START RPGINSFILE KEY NOT < RPGINS-KEY
                     INVALID GO TO SE-RPGINS-3.
       SE-RPGINS-2.
           READ RPGINSFILE NEXT AT END GO TO SE-RPGINS-3.
           IF RPGINS-KEY10 > FI-SEC-ALFA GO TO SE-RPGINS-3.
           ADD 1 TO CNTR
           IF FI-PRIM-ALFA(1:3) = "CIG"
            MOVE "CIGN      " TO INSTAB(CNTR)
            MOVE "102" TO INSCMS(CNTR)
            GO TO SE-RPGINS-3
           END-IF

           MOVE RPGINS-KEY TO INSTAB(CNTR)
           MOVE RPGINS-CMS TO INSCMS(CNTR)
           IF (RPGINS-CITY = FI-SEC-CITY)
            AND (RPGINS-STREET = FI-SEC-STR1)
            COMPUTE CNTR = 1
            MOVE RPGINS-KEY TO INSTAB(CNTR)
            MOVE RPGINS-CMS TO INSCMS(CNTR)
            GO TO SE-RPGINS-3
           END-IF
      *     DISPLAY CNTR " " RPGINS-KEY " " RPGINS-STREET
           
           IF CNTR > 14
            ACCEPT ANS
            IF ANS = "BK" 
             GO TO SE-RPGINS-1
            END-IF
            IF ANS = SPACE 
             MOVE 0 TO CNTR
             GO TO SE-RPGINS-2
            END-IF
           MOVE SPACE TO RIGHT-2
           UNSTRING ANS DELIMITED BY " " INTO RIGHT-2
           INSPECT RIGHT-2 REPLACING ALL " " BY "0"
            IF RIGHT-2 NUMERIC AND RIGHT-2 NOT = "00"
             GO TO SE-RPGINS-1
            END-IF
           MOVE RIGHT-2 TO X
           MOVE INSCMS(X) TO RPG-SEINS
           MOVE INSTAB(X) TO RPGINS-KEY
           GO TO SE-RPGINS-4
           END-IF.
           GO TO SE-RPGINS-2.
       SE-RPGINS-3.
           IF CNTR = 1
            MOVE INSCMS(1) TO RPG-SEINS
            MOVE INSTAB(1) TO RPGINS-KEY
            GO TO SE-RPGINS-4.
           IF CNTR = 0 
           PERFORM SE-ADD-INS THRU SE-ADD-INS-EXIT
           GO TO P1-1.
           DISPLAY "NO SELECTION WAS MADE"
           DISPLAY "DO YOU WISH TO ADD AS A NEW INSURANCE?  Y"
           
           DISPLAY FI-SEC-ALFA " " FI-SEC-NAME
           DISPLAY FI-SEC-STR1 
           DISPLAY FI-SEC-CITY " " FI-SEC-STATE " " FI-SEC-ZIP 
           DISPLAY " "
           ACCEPT ANS
           IF ANS = "Y" MOVE 0 TO CNTR GO TO SE-RPGINS-3.
           GO TO SE-RPGINS-1.
       SE-RPGINS-4.
           MOVE RPG-SEINS TO INS-KEY
           READ INSFILE INVALID 
              DISPLAY RPGINS-KEY " HAS A BAD 3-DIGIT CODE " RPG-SEINS
              DISPLAY "FIX IT AND RESTART PROGRAM"
              ACCEPT ANS
              GO TO P99
           END-READ
           MOVE INS-ASSIGN TO RPG-SE-ASSIGN
           MOVE INS-KEY TO RPG-SEINS
             
           IF (RPG-PRINS = "003") AND (RPG-SEINS NOT = "001")
            IF RPGINS-GAP NUMERIC
             MOVE "062" TO RPG-SEINS
             MOVE "A" TO RPG-SE-ASSIGN
             MOVE SPACE TO RPG-PR-GROUP
             MOVE RPGINS-GAP TO RPG-PR-GROUP
            END-IF
           END-IF.  
             IF RPG-SEINS = "076" OR "091"
              MOVE RPGINS-KEY TO RPG-SE-GROUP
              MOVE "A" TO RPG-SE-ASSIGN 
             END-IF.

       P1-1.
           IF RPG-PRINS = "116"
              MOVE RPG-PRIPOL TO POLTEST
              IF (POLTEST1-1 = "W" OR "M" OR "A")
               MOVE "028" TO RPG-PRINS RPG-PAYCODE
               MOVE "E" TO RPG-PAPER
               MOVE "A" TO RPG-ASSIGN RPG-NEIC-ASSIGN
              END-IF
           END-IF.
           IF RPG-PRINS = "002"
              MOVE RPG-PRIPOL TO POLTEST
              IF (POLTEST1 NOT = "ZI" )
               MOVE "268" TO RPG-PRINS RPG-PAYCODE
               MOVE "E" TO RPG-PAPER
              END-IF
           END-IF.
           IF RPG-PRINS = "004"
            MOVE "       " TO RPG-PRIPOL(10:7)
           END-IF

           MOVE RPGACTFILE01 TO SAVEMASTER
           READ RPGACTFILE 

             INVALID

              MOVE SAVEMASTER TO RPGACTFILE01
              WRITE RPGACTFILE01 
              END-WRITE

             NOT INVALID

              MOVE RPG-GARNO TO ALF8
              MOVE SAVEMASTER TO RPGACTFILE01
              MOVE ALF8 TO RPG-GARNO
              REWRITE RPGACTFILE01
              END-REWRITE
           END-READ.



              MOVE RPGACTFILE01 TO NEWINS01
                WRITE NEWINS01 INVALID
                 REWRITE NEWINS01
                 END-REWRITE
                END-WRITE

           MOVE RPG-GARNAME TO RPG-NAME
           MOVE RPG-PRINS TO RPG-PAYCODE
           MOVE SPACE TO RPG-DATE-T TEST-DATE
           UNSTRING FI-DATE-T DELIMITED BY "/" INTO T-MM T-DD T-YYYY

           MOVE SPACE TO RIGHT-2
           UNSTRING T-MM DELIMITED BY " " INTO RIGHT-2
           INSPECT RIGHT-2 REPLACING ALL " " BY "0"
           MOVE RIGHT-2 TO T-MM

           MOVE SPACE TO RIGHT-2
           UNSTRING T-DD DELIMITED BY " " INTO RIGHT-2
           INSPECT RIGHT-2 REPLACING ALL " " BY "0"
           MOVE RIGHT-2 TO T-DD
           MOVE TEST-DATE TO RPG-DATE-T

           MOVE SPACE TO RPG-DAT1 TEST-DATE
           UNSTRING FI-DAT1 DELIMITED BY "/" INTO T-MM T-DD T-YYYY
           MOVE SPACE TO RIGHT-2
           UNSTRING T-MM DELIMITED BY " " INTO RIGHT-2
           INSPECT RIGHT-2 REPLACING ALL " " BY "0"
           MOVE RIGHT-2 TO T-MM

           MOVE SPACE TO RIGHT-2
           UNSTRING T-DD DELIMITED BY " " INTO RIGHT-2
           INSPECT RIGHT-2 REPLACING ALL " " BY "0"
           MOVE RIGHT-2 TO T-DD
           MOVE TEST-DATE TO RPG-DAT1
           IF RPG-DAT1 NOT NUMERIC
           MOVE "00000000" TO RPG-DAT1.


           IF NOT (FI-PLACE = "MVFHC  " OR "CFHC   " OR "RUTLAND"
                            OR "SHOREW " OR "APFHC  ")
            MOVE SPACE TO FILEOUT01
            STRING RPG-GARNAME " " FI-PROC " " FI-DATE-T " " FI-PLACE
            " place of service error"
            DELIMITED BY SIZE INTO FILEOUT01
            WRITE FILEOUT01
           end-if
           MOVE "C" TO RPG-PLACE.
           IF FI-PLACE = "MVFHC  " MOVE "M" TO RPG-PLACE.
           IF FI-PLACE = "RUTLAND" MOVE "R" TO RPG-PLACE.
           IF FI-PLACE = "SHOREW " MOVE "S" TO RPG-PLACE.
           IF FI-PLACE = "APFHC  " MOVE "A" TO RPG-PLACE.

           MOVE FI-PROC TO ALF-7X
           MOVE "26" TO  ALF-7X2
           MOVE ALF-7X TO RPGPROC-KEY1
           MOVE SPACE TO RPGPROC-KEY2
           READ RPGPROCFILE INVALID 
           DISPLAY "BAD PROC " FI-PROC
           MOVE SPACE TO FILEOUT01
           STRING RPG-GARNAME " " FI-PROC " " FI-DATE-T " bad proc"
           DELIMITED BY SIZE  INTO FILEOUT01
           WRITE FILEOUT01
           MOVE SPACE TO RPG-NT1
           MOVE 0 TO RPGPROC-AMOUNT.
           COMPUTE NUM6 = (100 * RPGPROC-AMOUNT)
           MOVE NUM6 TO RPG-AMOUNT
           MOVE RPG-NT1 TO RPG-PROC1
           MOVE ALF-7X TO RPG-PROC2
           MOVE "5" TO RPG-SERVICE.
       DIAG-XX.
           MOVE SPACES TO DIAG-ARRAY01
           MOVE FI-DX1 TO ALFATAB01
           PERFORM DIAG-1
           MOVE DIAGTAB01 TO DIAG-ARRAY(1)
           MOVE FI-DX2 TO ALFATAB01
           PERFORM DIAG-1
           MOVE DIAGTAB01 TO DIAG-ARRAY(2)
           MOVE FI-DX3 TO ALFATAB01
           PERFORM DIAG-1
           MOVE DIAGTAB01 TO DIAG-ARRAY(3)
           MOVE FI-DX4 TO ALFATAB01
           PERFORM DIAG-1
           MOVE DIAGTAB01 TO DIAG-ARRAY(4)
      *     display diag-array01
           move 0 to cntr-x
           PERFORM VARYING X FROM 1 BY 1 UNTIL X > 4
              if rpg-date-t < "20151001"
               move diag-array(x) to alf7
               inspect alf7(1:5) replacing all " " by "0"
               move "??" to alf7(6:2)
               move alf7 to diag-array(x)
              end-if
             MOVE DIAG-ARRAY(X) TO DIAG-KEY
             READ DIAGFILE INVALID continue
              NOT INVALID
              add 1 to cntr-x
              if rpg-date-t < "20151001"
                move diag-medb to diag-array(cntr-x)
               else
                MOVE DIAG-KEY TO DIAG-ARRAY(CNTR-X)
              end-if
             END-READ
           END-PERFORM

           add 1 to cntr-x giving cntr-y

           PERFORM VARYING X FROM CNTR-Y BY 1 UNTIL X > 4
           MOVE "0000000" TO DIAG-ARRAY(X)
           END-PERFORM

           MOVE SPACE TO RPG-MOD2
           MOVE 0 TO TALLYRIT tallylit tallyrt tallylt
                     TALLYR TALLYL
           PERFORM VARYING X FROM 1 BY 1 UNTIL X > CNTR-X
            IF diag-array(X) not = "0000000"
             move diag-array(X) to diag-key
             read diagfile invalid continue
              not invalid
              INSPECT DIAG-Title TALLYING TALLYRIT FOR ALL " RIGHT "
              INSPECT DIAG-Title TALLYING TALLYLIT FOR ALL " LEFT "
              INSPECT DIAG-Title TALLYING TALLYRT FOR ALL " RT "
              INSPECT DIAG-Title TALLYING TALLYLT FOR ALL " LT "
              INSPECT DIAG-Title TALLYING TALLYR FOR ALL " R "
              INSPECT DIAG-Title TALLYING TALLYL FOR ALL " L "

              compute tallyx = tallyrit + tallylit + tallyrt + tallylt
                                        + TALLYR + TALLYL
              IF tallyx NOT = 0

               IF TALLYRIT > 0 OR TALLYRT > 0 OR TALLYR > 0
                   MOVE "RT" TO RPG-MOD2
                 ELSE
                   MOVE "LT" TO RPG-MOD2
               END-IF
              END-IF
             END-READ
            END-IF
           END-PERFORM
           IF ((RPG-DIAG > "79999" AND < "90000")
                OR (RPG-DX2 > "79999" AND < "90000")
                OR (RPG-DX3 > "79999" AND < "90000"))
           AND (RPG-DAT1 = ZEROES)
           MOVE RPG-DATE-T TO RPG-DAT1.
           MOVE RPG-DOB TO RPG-GARNO.
           MOVE 0 TO REFFLAG FLAG.
           MOVE DIAG-ARRAY(1) TO RPG-DIAG
           MOVE DIAG-ARRAY(2) TO RPG-DX2
           MOVE DIAG-ARRAY(3) TO RPG-DX3
           MOVE DIAG-ARRAY(4) TO RPG-DX4.

       4A-REF.
           MOVE FI-NPI TO NPI-KEY
           READ NPIFILE INVALID
           DISPLAY FI-NPI " BAD NPI"
           ACCEPT OMITTED
           WRITE FILEOUT201 FROM FILEIN01
           GO TO P1
           END-READ
           MOVE 0 TO FLAG
           IF FI-PROVNAMEL(1:6) = "TURNER"
           AND FI-PROVNAMEF(1:1) = "D"
           MOVE "T26" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL(1:6) = "COTTON"
           AND FI-PROVNAMEF(1:1) = "M"
           MOVE "C3T" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL(1:7) = "TINSMAN"
           AND FI-PROVNAMEF(1:1) = "J"
           MOVE "T0E" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL(1:4) = "WOLK"
           AND FI-PROVNAMEF(1:1) = "L"
           MOVE "W2C" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:8) = "MCKENZIE"
           AND FI-PROVNAMEF(1:1) = "D"
           MOVE "M4A" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:7) = "HAYWOOD"
           AND FI-PROVNAMEF(1:1) = "T"
           MOVE "H2L" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:14) = "SHELDON MORRIS"
           AND FI-PROVNAMEF(1:1) = "E"
           MOVE "S2V" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:6) = "HEFLIN"
           AND FI-PROVNAMEF(1:1) = "R"
           MOVE "H48" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:7) = "WOODARD"
           AND FI-PROVNAMEF(1:1) = "L"
           MOVE "W1T" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:5) = "KAHNG"
           AND FI-PROVNAMEF(1:1) = "P"
           MOVE "K1A" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:9) = "BARRINGER"
           AND FI-PROVNAMEF(1:1) = "K"
           MOVE "B2B" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:5) = "COREY"
           AND FI-PROVNAMEF(1:1) = "A"
           MOVE "C1E" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:14) = "METTOWEE NURSE"
           MOVE "B42" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:15) = "CASTLETON NURSE"
           MOVE "D05" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:13) = "RUTLAND NURSE"
           MOVE "M27" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:6) = "HUGHES"
           AND FI-PROVNAMEF(1:1) = "J"
           MOVE "H1V" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:5) = "DUSHA"
           AND FI-PROVNAMEF(1:1) = "M"
           MOVE "D1D" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:9) = "WAGENBACH"
           AND FI-PROVNAMEF(1:1) = "P"
           MOVE "W1M" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:6) = "MARTEL"
           AND FI-PROVNAMEF(1:1) = "C"
           MOVE "M2E" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:7) = "GOODWIN"
           AND FI-PROVNAMEF(1:1) = "W"
           MOVE "G1Y" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:5) = "FJELD"
           AND FI-PROVNAMEF(1:1) = "G"
           MOVE "F13" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:6) = "WASMUS"
           AND FI-PROVNAMEF(1:1) = "L"
           MOVE "W1E" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:5) = "LOVKO"
           AND FI-PROVNAMEF(1:1) = "T"
           MOVE "L19" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "BAUZO"      
           MOVE "B20" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "KORNBLUTH"      
           MOVE "K30" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "NAHAS"      
           MOVE "N06" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "BECKER"      
           MOVE "B60" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "BECKLER"      
           MOVE "B42" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "BERRYHILL"
           MOVE "B56" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "THORNTON"      
           MOVE "T17" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "DASHNAW"
           MOVE "D22" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "DIERCKSEN"
           MOVE "D05" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "FOSTER"
           MOVE "F30" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "JORDAN"
           MOVE "J01" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "WIESENFELD"
           MOVE "W46" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "MASILLO"
           MOVE "M38" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "LENSING"
           MOVE "L23" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "MESSIER"
           MOVE "M27" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "KINGSBAUER"
           MOVE "K44" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "STEVENS"
           MOVE "S68" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "BAKER"
           MOVE "B43" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:5) = "KURAK"
            AND FI-PROVNAMEF(1:1) = "K"
           MOVE "K00" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:7) = "SPERBER"
            AND FI-PROVNAMEF(1:1) = "K"
           MOVE "S0D" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:5) = "STALL"
            AND FI-PROVNAMEF(1:1) = "J"
           MOVE "S1J" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:7) = "STEVENS"
            AND FI-PROVNAMEF(1:1) = "M"
           MOVE "S1K" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:6) = "GAMBLE"
            AND FI-PROVNAMEF(1:1) = "L"
           MOVE "G1E" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:9) = "GREENLEAF"
            AND FI-PROVNAMEF(1:1) = "M"
           MOVE "G1J" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL(1:7) = "BROWER "
            AND FI-PROVNAMEF(1:1) = "K"
           MOVE "B0U" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL = "MORGAN"
            AND FI-PROVNAMEF(1:2) = "WS"
           MOVE "M44" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "MORGAN"
            AND FI-PROVNAMEF(1:1) = "J"
           MOVE "M58" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL = "ELLWOOD"
           MOVE "E10" TO RPG-DOCR GO TO P2.

           IF FI-PROVNAMEL = "FELLENZ"                                                                 
           MOVE "F31" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL =  "GORTON"                                                       
           MOVE "G31" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "KILPATRICK"
           MOVE "K25" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "KORNBLUTH"
           MOVE "K30" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "LAGER"
           MOVE "L30" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "MITCHELL"
           MOVE "M62" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "MYERS"
           MOVE "M16" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "MUELLER"
           MOVE "M53" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "READ"
           MOVE "D05" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "ROSMUS"
           MOVE "R06" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "SMITH"
           MOVE "S22" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "WEISBORD"
           MOVE "W24" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "VAIL"
           MOVE "V09" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "STALL"
           MOVE "S82" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "DABBS"
           MOVE "D47" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "BETHEL"
           MOVE "B72" TO RPG-DOCR GO TO P2.
           IF FI-PROVNAMEL = "HILL"
           MOVE "H54" TO RPG-DOCR GO TO P2.

           MOVE SPACE TO ALF8TEST
           MOVE FI-PROVNAMEL(1:1) TO ALF8TEST
           MOVE FI-PROVNAMEL(1:1) TO ALF-1
           MOVE 0 TO Y
           MOVE SPACE TO REF-KEY
           MOVE ALF-1 TO REF-KEY
           START REFPHY KEY NOT < REF-KEY INVALID GO TO REF-2.
       4B-REF.
           READ REFPHY NEXT AT END GO TO REF-2.
           MOVE REF-TITLE4 TO ALF-1X
           IF ALF-1 NOT = ALF-1X GO TO REF-2.
           IF REF-TITLE4(1:4) = FI-PROVNAMEL(1:4)
           ADD 1 TO Y 
           MOVE REF-NAME TO NAMETAB(Y) 
           MOVE REF-KEY TO NAMEKEYTAB(Y). 
           GO TO 4B-REF.
       REF-2. IF Y NOT = 0 GO TO REF-3.
              DISPLAY FI-PROVNAMEL " ORDER DOC".
       REF-2X.
           DISPLAY "ENTER YOUR OWN CODE"
           ACCEPT ANS
           MOVE ANS TO REF-KEY
           READ REFPHY INVALID GO TO REF-2X.
           DISPLAY REF-NAME " Y/N ?"
           ACCEPT ANS
           IF ANS NOT =  "Y" GO TO REF-2X.
           MOVE REF-KEY TO RPG-DOCR GO TO P2.
       REF-3.
           PERFORM REF-PICK VARYING X FROM 1 BY 1 UNTIL X > Y.
           DISPLAY FI-PROVNAMEL " " FI-PROVNAMEF
           ACCEPT ALF-3.
           IF ALF-3 = "B" GO TO REF-2X.
           MOVE SPACE TO RIGHT-2
           UNSTRING ALF-3 DELIMITED BY " " INTO RIGHT-2
           INSPECT RIGHT-2 REPLACING ALL " " BY "0".
           IF RIGHT-2 NOT NUMERIC DISPLAY "BAD PICK" GO TO REF-3.
           MOVE RIGHT-2 TO X
           IF X = 0 OR X > Y
           DISPLAY "BAD CHOICE. DO IT AGAIN!" GO TO REF-3.
           MOVE NAMEKEYTAB(X) TO RPG-DOCR.
           GO TO P2.
       REF-PICK. DISPLAY X " " NAMETAB(X) " " NAMEKEYTAB(X).
       P2.

           IF RPG-PROC1 = "1402" MOVE "1405" TO RPG-PROC1. 

           MOVE RPG-ACTNO TO RPG-KEY8
           MOVE 0 TO XYZ
           MOVE RPGCHARFILE01 TO SAVE-RPGCHARFILE.
       ADD-X. ADD 1 TO XYZ
           MOVE XYZ TO RPG-KEY3
           READ RPGCHARFILE INVALID
           MOVE SAVE-RPGCHARFILE TO RPGCHARFILE01
           MOVE XYZ TO RPG-KEY3
           WRITE RPGCHARFILE01 
           GO TO P1.
           GO TO ADD-X.
       INIT-1. 
           MOVE SPACE TO RPGACTFILE01 RPGCHARFILE01
           MOVE ZEROES TO RPG-LASTBILL RPG-INSPEND 
           MOVE "1" TO RPG-DUNNING RPG-ACCTSTAT
           MOVE "0" TO RPG-COLLT RPG-TRINSIND
           MOVE "001" TO RPG-SEINS RPG-TRINS RPG-PAYCODE
           MOVE "U" TO RPG-SE-ASSIGN
           MOVE "02" TO RPG-DOCP
           MOVE "1" TO RPG-RESULT 
           MOVE "01" TO RPG-WORK 
           MOVE "4" TO RPG-ACT
           MOVE "2" TO RPG-EPSDT 
           MOVE "2" TO RPG-SORCREF 
           MOVE "0" TO RPG-AUTH
           MOVE "0" TO RPG-STAT
           MOVE "0" TO RPG-COLLECT
           MOVE SPACE TO RPG-ACC-TYPE 
           MOVE SPACE TO RPG-FUTURE
           MOVE SPACE TO RPG-PATID RPG-CLAIM
           MOVE ZEROES TO RPG-DAT1 RPG-DATE-A RPG-DATE-M
           MOVE SPACE TO RPG-MOD3 RPG-MOD4
           MOVE DATE-TODAY TO RPG-DATE-E
           MOVE RPG-GARNAME TO RPG-NAME.

       DIAG-1.
           MOVE 0 TO CNTR
           PERFORM A1 VARYING X FROM 1 BY 1 UNTIL X > 8.
           
       A1. 
           IF ALFATAB(X) NOT = "."
           ADD 1 TO CNTR 
           MOVE ALFATAB(X) TO DIAGTAB(CNTR)
           IF DIAGTAB(CNTR) = SPACE
           MOVE " " TO DIAGTAB(CNTR)
           END-IF.
       ALREADY-1.    
           DISPLAY S-ACTNO
           DISPLAY RPG-BILLADD " " S-BILLADD 
           DISPLAY RPG-STREET " " S-STREET
           DISPLAY RPG-CITY " " S-CITY 
           DISPLAY RPG-STATE " " S-STATE 
           DISPLAY RPG-PRINS RPG-PRIPOL " " S-PRINS S-PRIPOL
           DISPLAY RPG-SEINS RPG-SECPOL " " S-SEINS S-SECPOL.
       INS-1. DISPLAY "SEARCH TYPE"
           DISPLAY "1 = BY NUMBER "
           DISPLAY "2 = BY NAME"
           DISPLAY "3 = BY ASSIGNMENT CODE"
           DISPLAY "4 = BY NEIC CODE"
           DISPLAY "5 = BY NEIC ASSIGNM CODE"
           DISPLAY "6 = BY CLAIM-TYPE"
           DISPLAY "7 = BY CITY".
       INS-2.  ACCEPT IN-FIELD.
           IF IN-FIELD = "?"
           DISPLAY "X = BACK OR 1-6 SEARCH METHOD"
           GO TO INS-2.
           IF IN-FIELD = "X" DISPLAY "END SEARCH" GO TO INS-1-EXIT.
           IF IN-FIELD = "1" OR "2" OR "3" OR "4" OR "5" OR "6" OR "7"
           NEXT SENTENCE ELSE DISPLAY "BAD" GO TO INS-2.
           MOVE IN-FIELD TO ALF-1.
       INS-3. DISPLAY "STARTING POINT?".
           ACCEPT IN-FIELD.
           IF IN-FIELD = "?"
           DISPLAY "ENTER WHERE TO START LOOKING"
           DISPLAY "BK = BACK TO SEARCH METHOD"
           DISPLAY "OR X = BACK TO OPTION" GO TO INS-3.
           IF IN-FIELD = "X" GO TO INS-1-EXIT.
           IF IN-FIELD = "BK" GO TO INS-1.
           MOVE 0 TO X
           IF ALF-1 = "1" MOVE SPACE TO RIGHT-3
           UNSTRING IN-FIELD DELIMITED BY " " INTO RIGHT-3
           INSPECT RIGHT-3 REPLACING LEADING " " BY "0"
           MOVE RIGHT-3 TO INS-KEY
           MOVE "NUMBER  " TO ALF-8
           START INSFILE KEY NOT < INS-KEY INVALID GO TO INS-1-END.
           IF ALF-1 = "2" MOVE IN-FIELD TO INS-NAME
           MOVE "NAME    " TO ALF-8
           START INSFILE KEY NOT < INS-NAME INVALID GO TO INS-1-END.
           IF ALF-1 = "3" MOVE IN-FIELD TO INS-ASSIGN
           MOVE "ASSIGNMT" TO ALF-8
           START INSFILE KEY NOT < INS-ASSIGN INVALID GO TO INS-1-END.
           IF ALF-1 = "4" MOVE IN-FIELD TO INS-NEIC
           MOVE "NEICCODE" TO ALF-8
           START INSFILE KEY NOT < INS-NEIC INVALID GO TO INS-1-END.
           IF ALF-1 = "5" MOVE IN-FIELD TO INS-NEIC-ASSIGN
           MOVE "NEICASGM" TO ALF-8
           START INSFILE KEY NOT < INS-NEIC-ASSIGN INVALID 
           GO TO INS-1-END.
           IF ALF-1 = "6" 
           MOVE IN-FIELD TO INS-CLAIMTYPE
           MOVE "CLM-TYPE" TO ALF-8
           START INSFILE KEY NOT < INS-CLAIMTYPE INVALID 
           GO TO INS-1-END.
           IF ALF-1 = "7" 
           MOVE IN-FIELD TO INS-CITY
           MOVE "CITY    " TO ALF-8
           START INSFILE KEY NOT < INS-CITY INVALID 
           GO TO INS-1-END.
       INS-4. READ INSFILE NEXT AT END DISPLAY "END OF FILE"
           GO TO INS-1-EXIT.
           DISPLAY INS-KEY " " INS-NAME " " INS-STREET 
           " " INS-CITY " " INS-STATE " " INS-CLAIMTYPE 
           ADD 1 TO X
           IF X > 8 MOVE 0 TO X DISPLAY "BY " ALF-8 ACCEPT ANS
           IF ANS NOT = SPACE GO TO INS-1-EXIT.
           GO TO INS-4.
       INS-1-END. DISPLAY "END OF FILE".
       INS-1-EXIT. EXIT.
       ADD-INS.
           MOVE FI-PRIM-ALFA TO RPGINS-KEY10
           MOVE SPACE TO RPGINS-KEY2
           MOVE 0 TO CNTR
           PERFORM ADD-1 THRU ADD-1-EXIT.
       ADD-INS-EXIT.
           EXIT.
       ADD-1.
           READ RPGINSFILE INVALID GO TO ADD-2.
            ADD 1 TO CNTR
            MOVE CNTR TO RPGINS-KEY2
            GO TO ADD-1.
       ADD-2. 
           MOVE FI-PRIM-NAME TO RPGINS-TITLE
           MOVE FI-PRIM-STR1 TO RPGINS-BOX
           MOVE SPACE  TO RPGINS-STREET
           MOVE FI-PRIM-CITY TO RPGINS-CITY
           MOVE FI-PRIM-STATE TO RPGINS-STATE
           MOVE FI-PRIM-ZIP TO RPGINS-ZIP
           IF RPGINS-ZIP(1:5) = " "
            MOVE SPACE TO ALF5
            STRING "0" RPGINS-ZIP(1:4) DELIMITED BY SIZE INTO ALF5
            MOVE SPACE TO RPGINS-ZIP
            MOVE ALF5 TO RPGINS-ZIP
           END-IF
           MOVE SPACE TO RPGINS-FUTURE
           DISPLAY RPGINS-TITLE.
           
       ADD-3.
           DISPLAY "076 OR 091 PAYCODE OR FI TO SEARCH".
           ACCEPT ANS
           IF ANS = "FI" GO TO ADD-4.
           IF NOT (ANS = "076" OR "091") GO TO ADD-3.
           MOVE ANS TO RPGINS-CMS
           MOVE SPACE TO RPGINS-GAP
           WRITE RPGINSFILE01.
           MOVE "A" TO RPG-ASSIGN
           MOVE "A" TO RPG-NEIC-ASSIGN
           MOVE "A" TO RPG-PR-ASSIGN
           MOVE "P" TO RPG-PAPER
           MOVE RPGINS-CMS TO RPG-PRINS
           MOVE RPGINS-CMS TO RPG-PAYCODE
           MOVE RPGINS-KEY TO RPG-PR-GROUP
           GO TO ADD-1-EXIT.
       ADD-4. 
           PERFORM INS-1 THRU INS-1-EXIT
           DISPLAY "ENTER A FOUND CODE OR BK TO RE-LOOK" 
           ACCEPT ANS
           IF ANS = "BK" GO TO ADD-3.
           IF ANS NOT NUMERIC  DISPLAY "BAD CODE" GO TO ADD-4.
           MOVE ANS TO INS-KEY
           READ INSFILE INVALID DISPLAY "BAD CODE" GO TO ADD-4.
           MOVE INS-KEY TO RPG-PRINS
           MOVE INS-ASSIGN TO RPG-ASSIGN
           MOVE INS-KEY TO RPG-PAYCODE
           MOVE INS-NEIC-ASSIGN TO RPG-NEIC-ASSIGN
           MOVE INS-CLAIMTYPE TO RPG-PAPER
           MOVE INS-KEY TO RPGINS-CMS
           MOVE SPACE TO RPGINS-GAP
           WRITE RPGINSFILE01.
       ADD-1-EXIT.
           EXIT.

       SE-ADD-INS.
           MOVE FI-SEC-ALFA TO RPGINS-KEY10
           MOVE SPACE TO RPGINS-KEY2
           MOVE 0 TO CNTR
           PERFORM SE-ADD-1 THRU SE-ADD-1-EXIT.
       SE-ADD-INS-EXIT.
           EXIT.
       SE-ADD-1.
           READ RPGINSFILE INVALID GO TO SE-ADD-2.
            ADD 1 TO CNTR
            MOVE CNTR TO RPGINS-KEY2
            GO TO SE-ADD-1.
       SE-ADD-2. 
           MOVE FI-SEC-NAME TO RPGINS-TITLE
           MOVE FI-SEC-STR1 TO RPGINS-BOX
           MOVE FI-SEC-STR2 TO RPGINS-STREET
           MOVE FI-SEC-CITY TO RPGINS-CITY
           MOVE FI-SEC-STATE TO RPGINS-STATE
           MOVE FI-SEC-ZIP TO RPGINS-ZIP
           IF RPGINS-ZIP(1:5) = " "
            MOVE SPACE TO ALF5
            STRING "0" RPGINS-ZIP(1:4) DELIMITED BY SIZE INTO ALF5
            MOVE SPACE TO RPGINS-ZIP
            MOVE ALF5 TO RPGINS-ZIP
           END-IF
           MOVE SPACE TO RPGINS-FUTURE
           DISPLAY RPGINS-TITLE.
           
       SE-ADD-3.
           DISPLAY "076 OR 091 PAYCODE OR FI TO SEARCH".
           ACCEPT ANS
           IF ANS = "FI" GO TO SE-ADD-4.
           IF NOT (ANS = "076" OR "091") GO TO SE-ADD-3.
           MOVE ANS TO RPGINS-CMS
           MOVE SPACE TO RPGINS-GAP
           WRITE RPGINSFILE01.
           MOVE RPGINS-CMS TO RPG-SEINS
           MOVE RPGINS-KEY TO RPG-SE-GROUP
           GO TO SE-ADD-1-EXIT.
       SE-ADD-4. 
           PERFORM INS-1 THRU INS-1-EXIT
           DISPLAY "ENTER A FOUND CODE OR BK TO RE-LOOK" 
           ACCEPT ANS
           IF ANS = "BK" GO TO SE-ADD-3.
           IF ANS NOT NUMERIC  DISPLAY "BAD CODE" GO TO SE-ADD-4.
           MOVE ANS TO INS-KEY
           READ INSFILE INVALID DISPLAY "BAD CODE" GO TO SE-ADD-4.
           MOVE INS-KEY TO RPG-SEINS
           MOVE INS-KEY TO RPGINS-CMS
           MOVE SPACE TO RPGINS-GAP
           WRITE RPGINSFILE01.
       SE-ADD-1-EXIT.
           EXIT.


       P99.
           CLOSE NEWINS RPGACTFILE RPGCHARFILE RPGPROCFILE RPGINSFILE
           REFPHY INSFILE FILEOUT FILEOUT2.
           DISPLAY "RPG XRAY DATA ENTRY PROGRAM HAS ENDED".
           STOP RUN.
