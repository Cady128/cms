      * @package cms
      * @link    http://www.cmsvt.com
      * @author  s waite <cmswest@sover.net>
      * @copyright Copyright (c) 2020 cms <cmswest@sover.net>
      * @license https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3
       IDENTIFICATION DIVISION.
       PROGRAM-ID. RRR062.
       AUTHOR. SID WAITE.
       DATE-COMPILED. TODAY.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PROVCAID ASSIGN TO "S30" ORGANIZATION IS INDEXED
           ACCESS IS DYNAMIC  RECORD KEY IS PROV-KEY
           ALTERNATE RECORD KEY IS PROV-NPI WITH DUPLICATES
           ALTERNATE RECORD KEY IS PROV-TAX WITH DUPLICATES
           ALTERNATE RECORD KEY IS PROV-NAME WITH DUPLICATES
           LOCK MODE MANUAL.
           SELECT FILEIN ASSIGN TO "S35" ORGANIZATION 
            LINE SEQUENTIAL.
           SELECT FILEOUT ASSIGN TO "S40" ORGANIZATION 
            LINE SEQUENTIAL.

       DATA DIVISION.
       FILE SECTION.
       FD  PROVCAID.
       01  PROVCAID01.
           02 PROV-KEY PIC X(7).
           02 PROV-NAME PIC X(24).
           02 PROV-NPI PIC X(10).
           02 PROV-TAX PIC X(10).
           02 PROV-REST.
            03 PROV-STREET PIC X(20).
            03 PROV-CITY PIC X(20).
            03 PROV-STATE PIC XX.
            03 PROV-ZIP PIC X(5).
       FD  FILEIN.
       01  FILEIN01 PIC X(60).
       FD  FILEOUT.
       01  FILEOUT01 PIC X(60).
       WORKING-STORAGE SECTION.
       01  NAMELAST PIC X(24).
       01  NAMEFIRST PIC X(24).
       01  FNAME PIC X(24).
       01  LNAME PIC X(24).

       01  ALF24 PIC X(20).
       01  ALF24X PIC X(20).
       01  ALF1 PIC X.
       01  FI-CDNUM PIC X(7).
       01  FI-NPI PIC X(10).
       01  FI-TAX PIC X(10).
       01  FI-NAME PIC X(30).
       01  TAB-X PIC XX VALUE H'09'.
       01  alf47 pic x(47).
       PROCEDURE DIVISION.
       P0. OPEN I-O PROVCAID INPUT FILEIN OUTPUT FILEOUT.
       P1.
           READ FILEIN AT END GO TO P99.
           MOVE SPACE TO FI-CDNUM FI-NPI FI-TAX FI-NAME alf47
           UNSTRING FILEIN01 DELIMITED BY TAB-X INTO
           FI-CDNUM FI-NPI FI-TAX FI-NAME ALF47
           MOVE FI-CDNUM TO PROV-KEY
           READ PROVCAID INVALID GO TO P2.
           GO TO P1.
       P2.
           MOVE SPACE TO PROVCAID01
           MOVE SPACE TO LNAME FNAME
           UNSTRING FI-NAME DELIMITED BY ", " OR ",  " INTO LNAME FNAME
           MOVE SPACE TO ALF24 ALF24X
           UNSTRING FNAME DELIMITED BY " " OR ","
           INTO ALF24 ALF24X
           MOVE SPACE TO PROV-NAME
           STRING LNAME ";" ALF24 DELIMITED BY " " INTO PROV-NAME
           MOVE FI-CDNUM TO PROV-KEY
           MOVE FI-TAX TO PROV-TAX
           MOVE FI-NPI TO PROV-NPI
           MOVE SPACE TO PROV-REST
           UNSTRING ALF47 DELIMITED BY "," INTO
           PROV-STREET PROV-CITY PROV-STATE PROV-ZIP
           DISPLAY PROVCAID01
           WRITE FILEOUT01 FROM PROVCAID01
      *     WRITE PROVCAID01
           GO TO P1.
       P99. CLOSE FILEIN PROVCAID FILEOUT.
           STOP RUN.
